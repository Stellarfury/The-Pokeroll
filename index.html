<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Pokéroll – The Pokémon Generator</title>
  <style>
    body {font-family:sans-serif;padding:1rem;}
    .big-btn {font-size:1.2rem;padding:.8rem 1.5rem;width:100%;margin-top:.5rem;}
    .center {text-align:center;}
    #game, #waiting, #result {display:none;}
    #diceResult img {width:100px;height:100px;}
    #logo {width:200px;height:200px;margin-bottom:20px;}
  </style>
  <script src="https:                                                                         
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
</head>
<body>
  <!-- Screens -->
  <div id="welcome" class="center">
    <video id="logo" autoplay loop muted>
      <source src="https:                                                  
      Your browser does not support the video tag.
    </video>
    <h2>Welcome to Pokéroll!</h2>
    <button class="big-btn" onclick="login()">Log In</button>
    <button class="big-btn" onclick="signup()">Sign Up</button>
    <button class="big-btn" onclick="playAsGuest()">Play as Guest</button>
  </div>
  <div id="waiting" class="center">
    <h2>Looking for an opponent…</h2>
  </div>
  <div id="game">
    <h2>Your turn – <span id="opponent"></span></h2>
    <div id="diceResult">Roll the dice!</div>
    <button class="big-btn" onclick="rollDice()">Roll Dice</button>
    <button class="big-btn" onclick="exitGame()">Exit Game</button>
    <hr>
    <div>Your score: <span id="myScore">0</span></div>
    <div>Opponent score: <span id="oppScore">0</span></div>
    <div id="timer">Time left: 10:00</div>
  </div>
  <div id="result" class="center">
    <h2 id="resultText"></h2>
    <button class="big-btn" onclick="startAnother()">Play Again</button>
  </div>

  <script type="module">
    const AUTH0_DOMAIN = 'dev-37bfnxzgvlr21vy3.us.auth0.com';
    const AUTH0_CLIENT_ID = 'OVpzcv3cyeM9Ca0G8zRuG9punYusiGeO';
    const auth0 = await createAuth0Client({
      domain: AUTH0_DOMAIN,
      client_id: AUTH0_CLIENT_ID,
      redirect_uri: window.location.origin
    });

    let socket = io('https:                    
    let roomId = null;
    let opponentId = null;
    let myScore = 0, oppScore = 0;
    let timer = 600;
    let timerInterval = null;

                 
    function show(id) { document.getElementById(id).style.display = 'block'; }
    function hide(id) { document.getElementById(id).style.display = 'none'; }

           
    async function login() {
      await auth0.loginWithPopup();
      showGameUI();
    }
    async function signup() {
      await auth0.loginWithPopup({ screen_hint: 'signup' });
      showGameUI();
    }
    function playAsGuest() {
      show('waiting');
      socket.emit('join', 'guest');
    }

                 
    socket.on('joined', (data) => {
      opponentId = data.opponent;
      show('game');
      hide('waiting');
      startTimer();
    });

    function rollDice() {
      const roll = Math.floor(Math.random() * 6) + 1;
      document.getElementById('diceResult').innerText = `You rolled: ${roll}`;
      socket.emit('roll', { roomId, roll });
      updateScore(roll);
    }

    function updateScore(roll) {
      myScore += roll;
      document.getElementById('myScore').innerText = myScore;
    }

    socket.on('opponent-roll', (data) => {
      oppScore += data.roll;
      document.getElementById('oppScore').innerText = oppScore;
    });

    function startTimer() {
      timerInterval = setInterval(() => {
        const m = Math.floor(timer / 60);
        const s = timer % 60;
        document.getElementById('timer').textContent = `Time left: ${m}:${s.toString().padStart(2, '0')}`;
        if (--timer <= 0) clearInterval(timerInterval);
      }, 1000);
    }

    function exitGame() { /* implement */ }
    function startAnother() { /* implement */ }
  </script>
</body>
</html>
